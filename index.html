<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AR.js Marker Test - Debug</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>
<body style='margin: 0; overflow: hidden; font-family: Arial, sans-serif;'>
    
    <!-- æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªAR.jsã‚·ãƒ¼ãƒ³è¨­å®š -->
    <a-scene embedded arjs='debugUIEnabled: true;'>
        
        <!-- 1. ã¾ãšHiroãƒãƒ¼ã‚«ãƒ¼ã§ãƒ†ã‚¹ãƒˆ -->
        <a-marker preset="hiro" id="hiro-test">
            <a-box position="0 0.5 0" color="red" scale="0.5 0.5 0.5"></a-box>
            <a-text value="HIRO OK" position="0 1 0" align="center" color="white"></a-text>
        </a-marker>
        
        <!-- 2. ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ã‚«ãƒ¼ã®ãƒ†ã‚¹ãƒˆï¼ˆè¤‡æ•°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è©¦ã™ï¼‰ -->
        
        <!-- ãƒ‘ã‚¿ãƒ¼ãƒ³1: pattern-marker.patt -->
        <a-marker type="pattern" url="./pattern-marker.patt" id="custom1">
            <a-box position="0 0.5 0" color="green" scale="0.5 0.5 0.5"></a-box>
            <a-text value="CUSTOM1 OK" position="0 1 0" align="center" color="white"></a-text>
        </a-marker>
        
        <!-- ãƒ‘ã‚¿ãƒ¼ãƒ³2: pattern-sample-p.patt (å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«) -->
        <a-marker type="pattern" url="./pattern-sample-p.patt" id="custom2">
            <a-box position="0 0.5 0" color="blue" scale="0.5 0.5 0.5"></a-box>
            <a-text value="CUSTOM2 OK" position="0 1 0" align="center" color="white"></a-text>
        </a-marker>
        
        <!-- ã‚«ãƒ¡ãƒ© -->
        <a-entity camera></a-entity>
    </a-scene>

    <!-- ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤ºãƒ‘ãƒãƒ« -->
    <div id="debug-info" style="position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.9); color: white; padding: 15px; border-radius: 8px; max-width: 350px; z-index: 1000; font-size: 12px;">
        <h3 style="margin: 0 0 10px 0; color: #00ff00;">ğŸ”§ AR.js Marker Debug</h3>
        
        <div id="file-check" style="margin: 10px 0; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">
            <strong>ğŸ“ File Status:</strong>
            <div id="file-status">ãƒã‚§ãƒƒã‚¯ä¸­...</div>
        </div>
        
        <div id="marker-check" style="margin: 10px 0; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">
            <strong>ğŸ¯ Marker Detection:</strong>
            <div>Hiro: <span id="hiro-status" style="color: #ff9800;">æœªæ¤œå‡º</span></div>
            <div>Custom1: <span id="custom1-status" style="color: #ff9800;">æœªæ¤œå‡º</span></div>
            <div>Custom2: <span id="custom2-status" style="color: #ff9800;">æœªæ¤œå‡º</span></div>
        </div>
        
        <div style="margin: 10px 0;">
            <button id="check-files" style="padding: 8px 12px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;">ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯</button>
        </div>
        
        <div id="instructions" style="margin: 10px 0; padding: 8px; background: rgba(33, 150, 243, 0.15); border-radius: 4px; font-size: 11px; color: #e3f2fd;">
            <strong>ğŸ¯ ãƒ†ã‚¹ãƒˆæ‰‹é †:</strong><br>
            1. Hiroãƒãƒ¼ã‚«ãƒ¼ã§èµ¤ã„ãƒœãƒƒã‚¯ã‚¹<br>
            2. pattern-marker.pngã§ç·‘ã®ãƒœãƒƒã‚¯ã‚¹<br>
            3. sample-p.jpgã§é’ã„ãƒœãƒƒã‚¯ã‚¹
        </div>
    </div>

    <script>
        let detectionCounts = {
            hiro: 0,
            custom1: 0,
            custom2: 0
        };

        // ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª
        async function checkFiles() {
            const files = [
                { name: 'pattern-marker.patt', url: './pattern-marker.patt' },
                { name: 'pattern-sample-p.patt', url: './pattern-sample-p.patt' },
                { name: 'sample-3.mp4', url: './assets/videos/sample-3.mp4' }
            ];
            
            let fileStatus = '';
            
            for (const file of files) {
                try {
                    const response = await fetch(file.url, { method: 'HEAD' });
                    if (response.ok) {
                        fileStatus += `âœ… ${file.name}: å­˜åœ¨<br>`;
                    } else {
                        fileStatus += `âŒ ${file.name}: 404ã‚¨ãƒ©ãƒ¼<br>`;
                    }
                } catch (error) {
                    fileStatus += `âŒ ${file.name}: ã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼<br>`;
                }
            }
            
            document.getElementById('file-status').innerHTML = fileStatus;
        }

        // ãƒãƒ¼ã‚«ãƒ¼æ¤œå‡ºã‚¤ãƒ™ãƒ³ãƒˆã®è¨­å®š
        function setupMarkerEvents() {
            // Hiroãƒãƒ¼ã‚«ãƒ¼
            const hiroMarker = document.querySelector('#hiro-test');
            if (hiroMarker) {
                hiroMarker.addEventListener('markerFound', function() {
                    detectionCounts.hiro++;
                    document.getElementById('hiro-status').textContent = `æ¤œå‡ºæ¸ˆã¿ (${detectionCounts.hiro})`;
                    document.getElementById('hiro-status').style.color = '#4caf50';
                    console.log('âœ… Hiro marker detected:', detectionCounts.hiro);
                });
                
                hiroMarker.addEventListener('markerLost', function() {
                    document.getElementById('hiro-status').textContent = `æ¶ˆå¤± (${detectionCounts.hiro})`;
                    document.getElementById('hiro-status').style.color = '#f44336';
                    console.log('âŒ Hiro marker lost');
                });
            }

            // ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ã‚«ãƒ¼1
            const custom1Marker = document.querySelector('#custom1');
            if (custom1Marker) {
                custom1Marker.addEventListener('markerFound', function() {
                    detectionCounts.custom1++;
                    document.getElementById('custom1-status').textContent = `æ¤œå‡ºæ¸ˆã¿ (${detectionCounts.custom1})`;
                    document.getElementById('custom1-status').style.color = '#4caf50';
                    console.log('âœ… Custom1 marker detected:', detectionCounts.custom1);
                });
                
                custom1Marker.addEventListener('markerLost', function() {
                    document.getElementById('custom1-status').textContent = `æ¶ˆå¤± (${detectionCounts.custom1})`;
                    document.getElementById('custom1-status').style.color = '#f44336';
                    console.log('âŒ Custom1 marker lost');
                });
            }

            // ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ã‚«ãƒ¼2
            const custom2Marker = document.querySelector('#custom2');
            if (custom2Marker) {
                custom2Marker.addEventListener('markerFound', function() {
                    detectionCounts.custom2++;
                    document.getElementById('custom2-status').textContent = `æ¤œå‡ºæ¸ˆã¿ (${detectionCounts.custom2})`;
                    document.getElementById('custom2-status').style.color = '#4caf50';
                    console.log('âœ… Custom2 marker detected:', detectionCounts.custom2);
                });
                
                custom2Marker.addEventListener('markerLost', function() {
                    document.getElementById('custom2-status').textContent = `æ¶ˆå¤± (${detectionCounts.custom2})`;
                    document.getElementById('custom2-status').style.color = '#f44336';
                    console.log('âŒ Custom2 marker lost');
                });
            }
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ AR.js Marker Debug Test starting...');
            
            // ãƒ•ã‚¡ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯ãƒœã‚¿ãƒ³
            document.getElementById('check-files').addEventListener('click', checkFiles);
            
            // åˆå›ãƒ•ã‚¡ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯
            setTimeout(checkFiles, 1000);
            
            // ãƒãƒ¼ã‚«ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®šï¼ˆå°‘ã—é…å»¶ï¼‰
            setTimeout(setupMarkerEvents, 3000);
            
            // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
            console.log('ğŸ“ Expected files:');
            console.log('- ./pattern-marker.patt');
            console.log('- ./pattern-sample-p.patt');
            console.log('- ./assets/videos/sample-3.mp4');
        });

        // ã‚¨ãƒ©ãƒ¼ç›£è¦–
        window.addEventListener('error', function(e) {
            console.error('ğŸš¨ JavaScript Error:', e.error);
        });

        // AR.jsã‚¨ãƒ©ãƒ¼ç›£è¦–
        document.addEventListener('camera-error', function(e) {
            console.error('ğŸš¨ Camera Error:', e.detail);
        });

        // 5ç§’ã”ã¨ã®çŠ¶æ…‹ç¢ºèª
        setInterval(function() {
            const scene = document.querySelector('a-scene');
            if (scene && scene.systems && scene.systems.arjs) {
                console.log('ğŸ“Š AR.js System Status:', {
                    initialized: true,
                    markers: Object.keys(detectionCounts),
                    detections: detectionCounts
                });
            }
        }, 5000);
    </script>
</body>
</html>